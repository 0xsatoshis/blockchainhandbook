# 区块链从入门到放弃

[胡成武](https://github.com/Colinhuu)（著）&copy; 2019

-----
## 引言

2019年10月24日[习近平在中央政治局第十八次集体学习时强调 把区块链作为核心技术自主创新重要突破口 加快推动区块链技术和产业创新发展](http://www.xinhuanet.com/politics/2019-10/25/c_1125153665.htm)

> 习近平在主持学习时发表了讲话。目前，全球主要国家都在加快布局区块链技术发展。我国在区块链领域拥有良好基础，要加快推动区块链技术和产业创新发展，积极推进区块链和经济社会融合发展。
  
> 习近平强调，要强化基础研究，提升原始创新能力，努力让我国在区块链这个新兴领域走在理论最前沿、占据创新制高点、取得产业新优势。要推动协同攻关，加快推进核心技术突破，为区块链应用发展提供安全可控的技术支撑。要加强区块链标准化研究，提升国际话语权和规则制定权。
  
> 习近平指出，要抓住区块链技术融合、功能拓展、产业细分的契机，发挥区块链在促进数据共享、优化业务流程、降低运营成本、提升协同效率、建设可信体系等方面的作用。要推动区块链和实体经济深度融合，解决中小企业贷款融资难、银行风控难、部门监管难等问题。要利用区块链技术探索数字经济模式创新，为打造便捷高效、公平竞争、稳定透明的营商环境提供动力，为推进供给侧结构性改革、实现各行业供需有效对接提供服务，为加快新旧动能接续转换、推动经济高质量发展提供支撑。要探索“区块链+”在民生领域的运用，积极推动区块链技术在教育、就业、养老、精准脱贫、医疗健康、商品防伪、食品安全、公益、社会救助等领域的应用，为人民群众提供更加智能、更加便捷、更加优质的公共服务。要推动区块链底层技术服务和新型智慧城市建设相结合，探索在信息基础设施、智慧交通、能源电力等领域的推广应用，提升城市管理的智能化、精准化水平。要利用区块链技术促进城市间在信息、资金、人才、征信等方面更大规模的互联互通，保障生产要素在区域内有序高效流动。要探索利用区块链数据共享模式，实现政务数据跨部门、跨区域共同维护和利用，促进业务协同办理，深化“最多跑一次”改革，为人民群众带来更好的政务服务体验。
  
> ......

区块链是对过往技术的重新组合，是现阶段信息科技创新的高潮。区块链 通过一种全新的信任机制--去信任化(Trustless)，使网络中不熟悉的节点间 也可以直接建立信任关系，每个节点有相同的网络权力，不再存在中心化的服 务器，任一节点停止工作都不会影响系统整体的运作。可以说，以往技术带来 的是生产力的提升，而区块链带来的是生产关系的改变。新的生产关系构建带 来的效率、安全提升将对各行业产生深远影响。

作为互联网从业者，我从2018年初正式关注区块链技术的发展，致力于区块链技术与线下实体产业的融合，在学习区块链的过程中会发现很多生涩难懂的术语，于是边学习边整理，故有此书。当然目前此书的目录排版以及内容，可能都不完善或者有其他待商榷的地方，欢迎大家指正，也希望借此能认识更多的同行者。本书仅作为学习参考使用，部分内容来自于网络，如有侵权，请联系作者删除。

胡成武，二〇一九年十一月，于杭州

## 区块链基础

### 1. 起源-不得不提的比特币

比特币（Bitcoin）的概念最初由中本聪在2008年11月1日提出，并于2009年1月3日正式诞生 [1]  。根据中本聪的思路设计发布的开源软件以及建构其上的P2P网络。比特币是一种P2P形式的虚拟的加密数字货币。点对点的传输意味着一个去中心化的支付系统。

与所有的货币不同，比特币不依靠特定货币机构发行，它依据特定算法，通过大量的计算产生，比特币经济使用整个P2P网络中众多节点构成的分布式数据库来确认并记录所有的交易行为，并使用密码学的设计来确保货币流通各个环节安全性。P2P的去中心化特性与算法本身可以确保无法通过大量制造比特币来人为操控币值。基于密码学的设计可以使比特币只能被真实的拥有者转移或支付。这同样确保了货币所有权与流通交易的匿名性。比特币与其他虚拟货币最大的不同，是其总数量非常有限，具有极强的稀缺性。

[比特币:一种点对点的电子现金系统](http://blockchainhandbooks.com/file/比特币白皮书.pdf)

### 2. 基础概念

####        1. 区块与区块链

**区块链**（英语：blockchain或 block chain）是借由密码学串接并保护内容的串连交易记录（又称区块）。每一个区块包含了前一个区块的加密散列、相应时间戳记以及交易数据（通常用默克尔树(Merkle tree)算法计算的散列值表示）

狭义来讲，是一种按照时间顺序将数据区块以顺序相连的方式组合成的一种链式数据结构， 并以密码学方式保证的不可篡改和不可伪造的分布式账本。

广义来讲，是利用块链式数据结构来验证与存储数据、利用分布式节点共识算法来生成和更新数据、利用密码学的方式保证数据传输和访问的安全、利用由自动化脚本代码组成的智能合约来编程和操作数据的一种全新的分布式基础架构与计算方式

主要分为：公有链、联盟链、私有链

>**公有链/ Public Blockchain**

公有链的任何节点都是向任何人开放的，每个人都可以参与到这个区块链中的计算，而且任何人都可以下载获得完整区块链数据，即全部账本。

>**联盟链/ Consortium Blockchain**

联盟链是指参与每个节点的权限都完全对等，各节点在不需要完全互信的情况下就可以实现数据的可信交换，联盟链的各个节点通常有与之对应的实体机构组织，通过授权后才能加入或退出网络。联盟链是一种公司与公司、组织与组织之间达成联盟的模式。

>**私有链/ Private Blockchain**

在某些区块链的应用场景下，开发者并不希望任何人都可以参与这个系统，因此建立一种不对外公开、只有被许可的节点才可以参与并且查看所有数据的私有区块链，私有链一般适用于特定机构的内部数据管理与审计。

####        2. Merkle Tree
默克尔树（Merkle tree，MT）是一种哈希二叉树，1979年由Ralph Merkle发明。在计算机科学中，二叉树是每个节点最多有两个子树的树结构，每个节点代表一条结构化数据。通常子树被称作“左子树”（left subtree）和“右子树”（right subtree）。二叉树常被用于实现数据快速查询。二叉树如下图所示。

![](imgs/tree.png)

>**A、Merkle树结构**

由一个根节点（root）、一组中间节点和一组叶节点（leaf）组成。叶节点（leaf）包含存储数据或其哈希值，中间节点是它的两个孩子节点内容的哈希值，根节点也是由它的两个子节点内容的哈希值组成。所以Merkle树也称哈希树。

>**B、哈希树的特点**

叶节点存储的是数据文件，而非叶节点存储的是其子节点的哈希值（Hash，通过SHA1、SHA256等哈希算法计算而来），这些非叶子节点的Hash被称作路径哈希值（可以据其确定某个叶节点到根节点的路径）, 叶节点的Hash值是真实数据的Hash值。因为使用了树形结构, 其查询的时间复杂度为 O(logn)，n是节点数量。

![](imgs/hash.png)

默克尔树的另一个特点是，底层数据的任何变动，都会传递到其父节点，一直到树根。

>**C、应用模式**

默克尔树的典型应用场景包括：
* **快速比较大量数据**：当两个默克尔树根相同时，则意味着所代表的数据必然相同（哈希算法决定的）。
* **快速定位修改**：例如上例中，如果 D1 中数据被修改，会影响到Hash0-0，Hash0 和 Root。因此，沿着 Root --> 0 --> 0-0，可以快速定位到发生改变的 D1；
* **零知识证明**：例如如何证明某个数据（D0……D3）中包括给定内容 D0，很简单，构造一个默克尔树，公布 N0，N1，N4，Root，D0拥有者可以很容易检测 D0 存在，但不知道其它内容。
相对于 Hash List，MT的明显的一个好处是可以单独拿出一个分支来（作为一个小树）对部分数据进行校验，这个很多使用场合就带来了哈希列表所不能比拟的方便和高效。正是源于这些优点，MT常用于分布式系统或分布式存储中

>**D、在分布式存储系统中的应用原理**

为了保持数据一致，分布系统间数据需要同步，如果对机器上所有数据都进行比对的话，数据传输量就会很大，从而造成“网络拥挤”。为了解决这个问题，可以在每台机器上构造一棵Merkle Tree，这样，在两台机器间进行数据比对时，从Merkle Tree的根节点开始进行比对，如果根节点一样，则表示两个副本目前是一致的，不再需要任何处理；如果不一样，则沿着hash值不同的节点路径查询，很快就能定位到数据不一致的叶节点，只用把不一致的数据同步即可，这样大大节省了比对时间以及数据的传输量。

>**E、比特币中的Merkle Tree**

比特币区块链系统中的采用的是Merkle二叉树，它的作用主要是快速归纳和校验区块数据的完整性，它会将区块链中的数据分组进行哈希运算，向上不断递归运算产生新的哈希节点，最终只剩下一个Merkle根存入区块头中，每个哈希节点总是包含两个相邻的数据块或其哈希值。
在比特币系统中使用Merkle树有诸多优点：首先是极大地提高了区块链的运行效率和可扩展性，使得区块头只需包含根哈希值而不必封装所有底层数据，这使得哈希运算可以高效地运行在智能手机甚至物联网设备上；其次是Merkle树可支持“简化支付验证协议”（SPV），即在不运行完整区块链网络节点的情况下，也能够对交易数据进行检验。所以，在区块链中使用Merkle树这种数据结构是非常具有意义的。

####        3. 哈希算法
####        4. 分叉、孤块与叔块
####        5. 分布式、P2P、非对称加密
####        6. UXTO模型、账户余额模型
###    3. 发展阶段
###    4. 特性
####        1. 去中心化
####        2. 匿名性
####        3. 不可篡改
####        4. 去信任
####        5. 开放性

## 区块链技术
###    1. 共识算法
####        1. POW、POS、DPOS
####        2. Paxos
####        3. PBFT
####        4. Raft
####        5. Ripple
####       6. Kafka、SOLO
####        7. POF、POC
###    2. 智能合约
###    3. 高频率协议
####        1. BIP32、BIP39、BIP44
####        2. ERC20、ERC721
###    4. 扩展性
####        1. 侧链（多条独立链）
####        2. 超大区块（增加区块容量）
####        3. 双层网络（channels和plasma）
####        4. 分片
####        5. 跨链
#####            1. 侧链
#####            2. 中继
#####            3. 公证人
#####            4. 哈希锁定
####        6. 其他
#####            1. 隔离见证
#####            2. DAG有向无环图
#####            3. 闪电网络
#####           4. 雷电网络
####        7. 链上扩容、链下扩容
###    5. 安全
####        1. 多重签名
####        2. 环签名
###    6. 隐私保护
####        1. 混币
####        2. 环签名
####        3. 同态加密
####        4. 零知识证明
####        5. 多方安全计算
###    7. 其他术语
####        1. IPFS
####        2. 石墨烯
####       3. DeFi
 
## 主要链
###    1. 比特币
###    2. 以太坊
###    3. EOS
###    4. HyperLedger Fabric
###    5. 其他区块链
####        1. EOS Force
####        2. Bytom
####        3. NEO
####        4. QTUM
####        5. GXChain
####        6. BAT
####        7. 国外的R3 CEV以及国内的R3 ChinaLedger 未开源
## 应用场景
###    1. 防伪溯源
###    2. 区块链农业
###    3. 政务
###    4. 电子票据
###    5. 版权保护
###    6. 金融
####        1. 证券
####        2. 保险
####        3. 供应链金额
####       4. 支付清算
## 发展趋势
## 风险
###    1. 量子计算：导致当前的加密规则失效
###    2. 分叉：信任危机
###    3. 双花、51%算力问题

## 关于作者
[胡成武]() 非主流程序员、坚定的区块链技术与应用践行者、独立房产投资人。

## 尾声
> 看了这么多，区块链是否真的那么深不可测呢？《区块链从入门到放弃》，嗯，放弃那是不可能的了。
